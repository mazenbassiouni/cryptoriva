<include file="Public:header"/>
<body class="nk-body body-wider bg-light-alt">
<div class="nk-wrap">

          <main class="wrapper dark-bg h-100-vh login">
            <div class="container">
              <div class="row justify-content-center inner-wrapper">
                <div class="col-md-12 col-lg-12 col-xl-12">
                  <div class="form-wrapper">
                    <div class="row align-items-center me-5">
                      <eq name="MOBILE_LAUNCHED" value="0">
                        <div class="col-sm-3 col-md-3 col-lg-3"></div>
                        </eq>
                      <div class="col-sm-5 col-md-5 col-lg-5">
                        <form
                          action=""
                          class="needs-validation"
                          method="post"
                          novalidate
                          id="login-form"
                        >
                          <h1 class="title text-center m-b-30">
                            <span class="h1 m-r-5 text-white font-bold"
                              >Sign in to {:SHORT_NAME}</span>
                          </h1>
                          <eq name="GOOGLE_LOGIN_ALLOWED" value="1">
                            
                            <a href="{:U('Login/googleLogin')}" class="btn white-bg btn-block btn-lg common-text" data-onsuccess="onSignIn">
                              
                            <span><img src='__EPSILON__/img/redesign/google-icon.svg'/> Signin with Google</span></a>
                            
                          </eq>


                          <br/>

                          <ul
                            id="login-tabs"
                            class="nav nav-pills nav-fill"
                            role="tablist"
                          >
                            <li class="nav-item">
                              <a
                                aria-selected="true"
                                class="nav-link "
                                data-toggle="pill"
                                href="#mobile-login"
                                data-target="#mobile-login"
                                role="tab"
                              >
                                <span>Phone Login</span></a>
                            </li>
                            <li class="nav-item">
                              <a
                                aria-selected="false"
                                class="nav-link active"
                                data-toggle="pill"
                                href="#email-login"
                                data-target="#email-login"
                                role="tab"
                              >
                                <span >E-mail Login </span></a
                              >
                            </li>
                          </ul>
                       
                          <div class="tab-content">
                            <div
                              class="tab-pane fade"
                              role="tabpanel"
                              id="mobile-login"
                            >
                              <div class="form-group">
                                <label for="phone" class="mb-24">Phone number</label>
                                <div class="input-group">
                        
                                  <input type="text" id="cellphones" class="texts" style="display: none;"> 
                                  <input
                                    class="pl-5 form-control"
                                    placeholder="Phone number"
                                    type="text"
                                    id="cellphone"
                                    required
                                  />
                                </div>
                              </div>
                              <div class="form-group">
                                <label for="enterPW1">Password</label>
                                <input
                                  class="form-control"
                                  placeholder="Password"
                                  type="password"
                                  id="enterPW1"
                                  pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$"
                                  autocomplete="no"
                                  required
                                />
                                <span class="input-inner-right"
                                  ><i class="fa fa-eye" id="eye-1" onclick="hideShowPass('enterPW1','eye-1')"></i
                                ></span>
                                <div class="invalid-feedback">
                                  Your password must contain at least 6 characters, 1
                                  uppercase letter, 1 lowercase letter and numbers.
                                </div>
                              </div>
                              <link rel="stylesheet" href="__EPSILON__/addons/intltelinput.css">
					
          <script src="__EPSILON__/addons/intlTelInput.js"></script>
					<script>
						$("#cellphones").intlTelInput({
							autoHideDialCode: false,
							defaultCountry: "us",
							nationalMode: false,
							preferredCountries: [ 'us', 'uk','in','cn','hk', 'tw', 'mo','it'],
						});
					</script>
                            </div>
                            <div
                              class="tab-pane fade  show active"
                              role="tabpanel"
                              id="email-login"
                            >
                              <div class="form-group">
                                <label for="email">E-mail</label>
                                <input
                                  class="form-control"
                                  id="username"
                                placeholder="{:l('USERNAME_OR_EMAIL')}"
                                  type="email"
                                  required
                                />
                              </div>
                              <div class="form-group">
                                <label for="enterPW1">Password</label>
                                <input
                                  class="form-control"
                                  type="password"
                                  id="login_password"
                                  placeholder="{:l('PLEASE_ENTER_YOUR_PASSWORD')}"
                                  pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}$"
                                  autocomplete="no"
                                  required
                                />
                                <span class="input-inner-right"
                                  ><i class="fa fa-eye" id="eye-2" onclick="hideShowPass('login_password','eye-2')"></i
                                ></span>
                                <div class="invalid-feedback">
                                  Your password must contain at least 6 characters, 1
                                  uppercase letter, 1 lowercase letter and numbers.
                                </div>
                              </div>
                              <div class="form-group">
                                <label for="enterPW1">Code</label>
                          
                                <div class="invalid-feedback">
                                  Code must not be empty
                                </div>
                                <div class="justify-content-between">
                                    <eq name="RECAPTCHA" value="1">
                                    <include file="Public:recaptcha"/>
                                    <else/>
                                    <include file="Public:image_captcha"/>
                                    </eq>
                                </div>
                              </div>
                            </div>
                          </div>
                          <a
                            href="#"
                            onclick="footer_user_login();"
                            class="btn btn-2 d-block w-100 m-t-30"
                        >{:l('LOG_IN')}</a
                          >
                          <div class="other-link">
                            <a href="{:U('Login/findpwd')}">I forgot my password</a
                            ><a href="{:U('Login/register')}" class="float-right">Sign up</a>
                          </div>
                        </form>
                      </div>
                      <div class="col-1"></div>
                      <eq name="MOBILE_LAUNCHED" value="1">
                      <div class="col-sm-6 col-md-4 col-lg-5">
                        <div class="qr-login">
                          <div class="h3 text-white heading-padding mb-4">Scan code to log in</div>
                         <div class="row">
                          <div class="col-md-6 col-12  ">
                            <div class="qr-box" id="qrcode1">
                          <img src="" class="img-fluid"/>
                        </div>
                          </div>
                          <div class="col-md-6 text-center d-none d-md-block">
                          <img class="qr-tip" src="__EPSILON__/img/scan.png" alt="">
                        </div>
                        </div>
                          <p class="text-white">Open {:SHORT_NAME} App </p>
                          <p class="text-white">
                            For instant login
                            <span class="yellow">With the {:SHORT_NAME} mobile app</span>
                            scan this code.
                          </p>
                        </div>
                      </div>
                    </eq>
                    </div>
                  </div>
                <!-- </div> -->
              </div>
              <!--/row-->
            </div>
          </main>
    
	</div>
	<script type="text/javascript" src="__PUBLIC__/Home/js/jquery.qrcode.min.js"></script>
<script>
    function footer_user_login() {
        
        var username = $("#username").val();
        var password = $("#login_password").val();
<eq name="RECAPTCHA" value="1">
        var verify = $("#g-recaptcha-response").val();
<else/>
        var verify = $("#login_verify").val();

</eq>
        if (username == "" || username == null) {
            layer.tips("Username", '#username', {tips: 2});
            return false;
        }
        if (password == "" || password == null) {
            layer.tips("Enter password", '#login_password', {tips: 2});
            return false;
        }
        
        if (verify == "" || verify == null) {
            layer.tips("Captcha", '.recaptcha', {tips: 2});
            return false;
            
        }
        $.post("{:U('Login/submit')}", {
            username: username,
            password: password,
            verify: verify,
            //login_token: "",
        }, function (data) {

            if (data.status == 1) {
                $.cookies.set('username', username);
                layer.msg(data.info, {icon: 1});
                if (data.url) {
                    window.location = data.url;
                } else {
                    window.location = "{:SITE_URL}";
                }
            } else {
                layer.msg(data.info, {icon: 2});
				        
                <eq name="RECAPTCHA" value="1">
                  grecaptcha.reset();
                  <else/>
                  $("#login_verify_up").click();
                </eq>
                if (data.url) {
                    window.location = data.url;
                }
            }
        }, "json");
    }

    function choose_lang(lang) {
        $.cookies.set("lang", lang);
        window.location.reload();
    }
    <eq name="GOOGLE_LOGIN_ALLOWED" value="1">
      function onSignIn(googleUser) {
  // Get user's ID token and basic profile information
  var id_token = googleUser.getAuthResponse().id_token;
  var profile = googleUser.getBasicProfile();

  // Send the ID token to your server for verification
  $.post("/verify-google-token", { id_token: id_token }, function(result) {
    if (result.success) {
      // Update UI to show user is signed in
      // ...
    } else {
      // Show error message
      // ...
    }
  });
}
      </eq>
      
		$('#qrcode1').qrcode({
                        render: "table", //table
                        size: 150,
                        text: '{$qrhash}', //Any content
						            background: "#ffffff",
                        class:"img-fluid"
                    }); 
                    let imgcontent	=$('#qrcode1').html();
                    function checkme() {
		$.get("{:U('Login/checkQr')}", function (data) {
      console.log(302,data);
			if (data.status == 1) {
        console.log(data)
        layer.msg(data.info, {icon: 1});
                if (data.url) {
                    window.location = data.url;
                } else {
                    window.location = "{:SITE_URL}";
                }
			} else {
        
			}
		}, "json");
	}
	
</script>
<include file="Public:footer_minimal"/>